{"visual":{"name":"matrixVisualReplica","displayName":"Matrix Visual Replica","guid":"matrixVisualReplica1234567890ABCDEF","visualClassName":"MatrixVisualReplica","version":"1.0.0.0","description":"A custom Power BI visual that fully replicates the native Matrix visual with 100% feature parity","supportUrl":"https://github.com","gitHubUrl":""},"author":{"name":"Matrix Visual Replica","email":"support@example.com"},"apiVersion":"5.10.0","style":"style/visual.less","stringResources":{},"capabilities":{"privileges":[],"dataRoles":[{"displayName":"Rows","name":"rows","kind":"Grouping","requiredTypes":[{"numeric":true},{"text":true}]},{"displayName":"Columns","name":"columns","kind":"Grouping","requiredTypes":[{"numeric":true},{"text":true}]},{"displayName":"Values","name":"values","kind":"Measure","requiredTypes":[{"numeric":true}]}],"dataViewMappings":[{"matrix":{"rows":{"for":{"in":"Rows"}},"columns":{"for":{"in":"Columns"}},"values":{"select":[{"for":{"in":"Values"}}]}}}],"expandCollapse":{"roles":["Rows"],"addDataViewFlags":{"defaultValue":true}},"drilldown":{"roles":["Rows"]},"objects":{"general":{"displayName":"General","properties":{"formatString":{"type":{"formatting":{"formatString":true}}}}},"rowHeaders":{"displayName":"Row headers","properties":{"fontFamily":{"type":{"text":true},"displayName":"Font family"},"fontSize":{"type":{"numeric":true},"displayName":"Font size"},"fontColor":{"type":{"fill":{"solid":{"color":true}}},"displayName":"Font color"},"backgroundColor":{"type":{"fill":{"solid":{"color":true}}},"displayName":"Background color"},"wordWrap":{"type":{"bool":true},"displayName":"Word wrap"},"alignment":{"type":{"enumeration":[{"displayName":"Left","value":"left"},{"displayName":"Center","value":"center"},{"displayName":"Right","value":"right"}]},"displayName":"Alignment"},"border":{"type":{"bool":true},"displayName":"Show border"}}},"columnHeaders":{"displayName":"Column headers","properties":{"fontFamily":{"type":{"text":true},"displayName":"Font family"},"fontSize":{"type":{"numeric":true},"displayName":"Font size"},"fontColor":{"type":{"fill":{"solid":{"color":true}}},"displayName":"Font color"},"backgroundColor":{"type":{"fill":{"solid":{"color":true}}},"displayName":"Background color"},"wordWrap":{"type":{"bool":true},"displayName":"Word wrap"},"alignment":{"type":{"enumeration":[{"displayName":"Left","value":"left"},{"displayName":"Center","value":"center"},{"displayName":"Right","value":"right"}]},"displayName":"Alignment"},"border":{"type":{"bool":true},"displayName":"Show border"}}},"values":{"displayName":"Values","properties":{"fontFamily":{"type":{"text":true},"displayName":"Font family"},"fontSize":{"type":{"numeric":true},"displayName":"Font size"},"fontColor":{"type":{"fill":{"solid":{"color":true}}},"displayName":"Font color"},"backgroundColor":{"type":{"fill":{"solid":{"color":true}}},"displayName":"Background color"},"alignment":{"type":{"enumeration":[{"displayName":"Left","value":"left"},{"displayName":"Center","value":"center"},{"displayName":"Right","value":"right"}]},"displayName":"Alignment"},"numberFormat":{"type":{"formatting":{"formatString":true}},"displayName":"Number format"},"decimalPlaces":{"type":{"numeric":true},"displayName":"Decimal places"},"conditionalFormatting":{"type":{"enumeration":[{"displayName":"None","value":"none"},{"displayName":"Background color","value":"background"},{"displayName":"Font color","value":"font"},{"displayName":"Data bars","value":"dataBars"},{"displayName":"Icons","value":"icons"}]},"displayName":"Conditional formatting"}}},"grid":{"displayName":"Grid","properties":{"gridlines":{"type":{"bool":true},"displayName":"Show gridlines"},"horizontalGridlines":{"type":{"bool":true},"displayName":"Horizontal gridlines"},"verticalGridlines":{"type":{"bool":true},"displayName":"Vertical gridlines"},"rowBanding":{"type":{"bool":true},"displayName":"Row banding"},"columnBanding":{"type":{"bool":true},"displayName":"Column banding"},"bandingColor":{"type":{"fill":{"solid":{"color":true}}},"displayName":"Banding color"},"padding":{"type":{"numeric":true},"displayName":"Padding"},"outlineStyle":{"type":{"enumeration":[{"displayName":"Stepped","value":"stepped"},{"displayName":"None","value":"none"}]},"displayName":"Outline style"}}},"totals":{"displayName":"Totals","properties":{"showRowSubtotals":{"type":{"bool":true},"displayName":"Show row subtotals"},"showColumnSubtotals":{"type":{"bool":true},"displayName":"Show column subtotals"},"showRowGrandTotals":{"type":{"bool":true},"displayName":"Show row grand totals"},"showColumnGrandTotals":{"type":{"bool":true},"displayName":"Show column grand totals"},"subtotalFontFamily":{"type":{"text":true},"displayName":"Subtotal font family"},"subtotalFontSize":{"type":{"numeric":true},"displayName":"Subtotal font size"},"subtotalFontColor":{"type":{"fill":{"solid":{"color":true}}},"displayName":"Subtotal font color"},"subtotalBackgroundColor":{"type":{"fill":{"solid":{"color":true}}},"displayName":"Subtotal background color"},"grandTotalFontFamily":{"type":{"text":true},"displayName":"Grand total font family"},"grandTotalFontSize":{"type":{"numeric":true},"displayName":"Grand total font size"},"grandTotalFontColor":{"type":{"fill":{"solid":{"color":true}}},"displayName":"Grand total font color"},"grandTotalBackgroundColor":{"type":{"fill":{"solid":{"color":true}}},"displayName":"Grand total background color"}}},"sorting":{"displayName":"Sorting","properties":{"sortBy":{"type":{"enumeration":[{"displayName":"By hierarchy","value":"hierarchy"},{"displayName":"By value","value":"value"}]},"displayName":"Sort by"},"sortDirection":{"type":{"enumeration":[{"displayName":"Ascending","value":"asc"},{"displayName":"Descending","value":"desc"}]},"displayName":"Sort direction"}}}},"supportsMultiVisualSelection":true,"supportsHighlight":true,"supportsKeyboardFocus":true},"content":{"js":"var matrixVisualReplica1234567890ABCDEF;(()=>{\"use strict\";var t={2(t,e,n){function r(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t}n.d(e,{A:()=>r})},4(t,e,n){n.d(e,{Bb:()=>s,Oc:()=>h,P9:()=>o,UO:()=>u});var r=n(7737),i=n(2415);function o(t){return i.Yo[t.index]={site:t,halfedges:[]}}function a(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function s(t,e){return e[+(e.left!==t.site)]}function l(t,e){return e[+(e.left===t.site)]}function u(){for(var t,e,n,r,o=0,s=i.Yo.length;o<s;++o)if((t=i.Yo[o])&&(r=(e=t.halfedges).length)){var l=new Array(r),u=new Array(r);for(n=0;n<r;++n)l[n]=n,u[n]=a(t,i.Jo[e[n]]);for(l.sort(function(t,e){return u[e]-u[t]}),n=0;n<r;++n)u[n]=e[l[n]];for(n=0;n<r;++n)e[n]=u[n]}}function h(t,e,n,o){var a,u,h,c,d,f,p,g,m,v,y,w,b=i.Yo.length,A=!0;for(a=0;a<b;++a)if(u=i.Yo[a]){for(h=u.site,c=(d=u.halfedges).length;c--;)i.Jo[d[c]]||d.splice(c,1);for(c=0,f=d.length;c<f;)y=(v=l(u,i.Jo[d[c]]))[0],w=v[1],g=(p=s(u,i.Jo[d[++c%f]]))[0],m=p[1],(Math.abs(y-g)>i.Ni||Math.abs(w-m)>i.Ni)&&(d.splice(c,0,i.Jo.push((0,r.iX)(h,v,Math.abs(y-t)<i.Ni&&o-w>i.Ni?[t,Math.abs(g-t)<i.Ni?m:o]:Math.abs(w-o)<i.Ni&&n-y>i.Ni?[Math.abs(m-o)<i.Ni?g:n,o]:Math.abs(y-n)<i.Ni&&w-e>i.Ni?[n,Math.abs(g-n)<i.Ni?m:e]:Math.abs(w-e)<i.Ni&&y-t>i.Ni?[Math.abs(m-e)<i.Ni?g:t,e]:null))-1),++f);f&&(A=!1)}if(A){var _,S,x,C=1/0;for(a=0,A=null;a<b;++a)(u=i.Yo[a])&&(x=(_=(h=u.site)[0]-t)*_+(S=h[1]-e)*S)<C&&(C=x,A=u);if(A){var N=[t,e],k=[t,o],H=[n,o],F=[n,e];A.halfedges.push(i.Jo.push((0,r.iX)(h=A.site,N,k))-1,i.Jo.push((0,r.iX)(h,k,H))-1,i.Jo.push((0,r.iX)(h,H,F))-1,i.Jo.push((0,r.iX)(h,F,N))-1)}}for(a=0;a<b;++a)(u=i.Yo[a])&&(u.halfedges.length||delete i.Yo[a])}},103(t,e,n){function r(t){var e=\"text\";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if(\"function\"!=typeof t)throw new Error;return this.tween(e,function(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&function(t){return function(e){this.textContent=t.call(this,e)}}(r)),e}return r._value=t,r}(t))}n.d(e,{A:()=>r})},114(t,e,n){n.d(e,{A:()=>i});var r=n(4036);function i(t,e,n){var i=new r.M4;return e=null==e?0:+e,i.restart(function(n){i.stop(),t(n+e)},e,n),i}},117(t,e,n){n.d(e,{A:()=>o,D:()=>i});var r=180/Math.PI,i={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function o(t,e,n,i,o,a){var s,l,u;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(u=t*n+e*i)&&(n-=t*u,i-=e*u),(l=Math.sqrt(n*n+i*i))&&(n/=l,i/=l,u/=l),t*i<e*n&&(t=-t,e=-e,u=-u,s=-s),{translateX:o,translateY:a,rotate:Math.atan2(e,t)*r,skewX:Math.atan(u)*r,scaleX:s,scaleY:l}}},267(t,e,n){function r(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this}n.d(e,{A:()=>r})},319(t,e,n){function r(t){return function(){return t}}n.d(e,{A:()=>r})},355(t,e,n){n.d(e,{A:()=>o});var r=n(6707),i=n(1927);function o(){return new i.LN(this._exit||this._groups.map(r.A),this._parents)}},362(t,e,n){Array.prototype.slice},478(t,e,n){n.d(e,{A:()=>a,J:()=>s});var r=n(2492);function i(t,e){var n,i;return function(){var o=(0,r.hZ)(this,t),a=o.tween;if(a!==n)for(var s=0,l=(i=n=a).length;s<l;++s)if(i[s].name===e){(i=i.slice()).splice(s,1);break}o.tween=i}}function o(t,e,n){var i,o;if(\"function\"!=typeof n)throw new Error;return function(){var a=(0,r.hZ)(this,t),s=a.tween;if(s!==i){o=(i=s).slice();for(var l={name:e,value:n},u=0,h=o.length;u<h;++u)if(o[u].name===e){o[u]=l;break}u===h&&o.push(l)}a.tween=o}}function a(t,e){var n=this._id;if(t+=\"\",arguments.length<2){for(var a,s=(0,r.Jt)(this.node(),n).tween,l=0,u=s.length;l<u;++l)if((a=s[l]).name===t)return a.value;return null}return this.each((null==e?i:o)(n,t,e))}function s(t,e,n){var i=t._id;return t.each(function(){var t=(0,r.hZ)(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return(0,r.Jt)(t,i).value[e]}}},481(t,e,n){n(2285),n(6479),n(6698)},499(t,e,n){n.d(e,{P:()=>l,i:()=>u});var r,i,o,a,s=n(117);function l(t){return\"none\"===t?s.D:(r||(r=document.createElement(\"DIV\"),i=document.documentElement,o=document.defaultView),r.style.transform=t,t=o.getComputedStyle(i.appendChild(r),null).getPropertyValue(\"transform\"),i.removeChild(r),t=t.slice(7,-1).split(\",\"),(0,s.A)(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}function u(t){return null==t?s.D:(a||(a=document.createElementNS(\"http://www.w3.org/2000/svg\",\"g\")),a.setAttribute(\"transform\",t),(t=a.transform.baseVal.consolidate())?(t=t.matrix,(0,s.A)(t.a,t.b,t.c,t.d,t.e,t.f)):s.D)}},655(t,e,n){n(8299),n(6696),n(8440)},837(t,e,n){n.d(e,{A:()=>r});const r=function t(e){function n(t){return function(){for(var n=0,r=0;r<t;++r)n+=e();return n}}return n.source=t,n}(n(6805).A)},875(t,e,n){n.d(e,{A:()=>l});var r=n(1927),i=n(7365),o=n(8464);function a(t,e,n,r,o,a){for(var s,l=0,u=e.length,h=a.length;l<h;++l)(s=e[l])?(s.__data__=a[l],r[l]=s):n[l]=new i.L(t,a[l]);for(;l<u;++l)(s=e[l])&&(o[l]=s)}function s(t,e,n,r,o,a,s){var l,u,h,c={},d=e.length,f=a.length,p=new Array(d);for(l=0;l<d;++l)(u=e[l])&&(p[l]=h=\"$\"+s.call(u,u.__data__,l,e),h in c?o[l]=u:c[h]=u);for(l=0;l<f;++l)(u=c[h=\"$\"+s.call(t,a[l],l,a)])?(r[l]=u,u.__data__=a[l],c[h]=null):n[l]=new i.L(t,a[l]);for(l=0;l<d;++l)(u=e[l])&&c[p[l]]===u&&(o[l]=u)}function l(t,e){if(!t)return v=new Array(this.size()),f=-1,this.each(function(t){v[++f]=t}),v;var n=e?s:a,i=this._parents,l=this._groups;\"function\"!=typeof t&&(t=(0,o.A)(t));for(var u=l.length,h=new Array(u),c=new Array(u),d=new Array(u),f=0;f<u;++f){var p=i[f],g=l[f],m=g.length,v=t.call(p,p&&p.__data__,f,i),y=v.length,w=c[f]=new Array(y),b=h[f]=new Array(y);n(p,g,w,b,d[f]=new Array(m),v,e);for(var A,_,S=0,x=0;S<y;++S)if(A=w[S]){for(S>=x&&(x=S+1);!(_=b[x])&&++x<y;);A._next=_||null}}return(h=new r.LN(h,i))._enter=c,h._exit=d,h}},920(t,e,n){n(5783),n(1902)},1058(t,e,n){n(8059),n(9798),n(481),n(3176),n(1831),n(6527),n(8900),n(1561),n(6371),n(9609),n(4725),n(7773),n(2011),n(7870),n(5889),n(6698)},1118(t,e,n){function r(){return[]}function i(t){return null==t?r:function(){return this.querySelectorAll(t)}}n.d(e,{A:()=>i})},1272(t,e,n){n.d(e,{Ltv:()=>r.Lt}),n(2765),n(2285),n(3103),n(7772),n(3274),n(1650),n(8534),n(655),n(1449),n(1058);var r=n(5278);n(8961),n(6690),n(8561)},1348(t,e,n){n.d(e,{A:()=>o});var r=n(1927),i=n(1118);function o(t){\"function\"!=typeof t&&(t=(0,i.A)(t));for(var e=this._groups,n=e.length,o=[],a=[],s=0;s<n;++s)for(var l,u=e[s],h=u.length,c=0;c<h;++c)(l=u[c])&&(o.push(t.call(l,l.__data__,c,u)),a.push(l));return new r.LN(o,a)}},1363(t,e,n){var r=n(2887),i=(0,n(5122).A)(r.A);i.right,i.left},1384(t,e,n){n(2285),n(1902)},1449(t,e,n){n(2385),n(6034),n(5128),n(2930),n(837),n(2794)},1508(t,e,n){var r=Array.prototype;r.slice,r.map},1561(t,e,n){n(2285),n(6911)},1650(t,e,n){n(8002),n(7490),n(5800)},1831(t,e,n){n(481),n(6479)},1848(t,e,n){function r(){this.textContent=\"\"}function i(t){return function(){this.textContent=t}}function o(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?\"\":e}}function a(t){return arguments.length?this.each(null==t?r:(\"function\"==typeof t?o:i)(t)):this.node().textContent}n.d(e,{A:()=>a})},1901(t,e,n){function r(t,e,n){this.k=t,this.x=e,this.y=n}r.prototype={constructor:r,scale:function(t){return 1===t?this:new r(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new r(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return\"translate(\"+this.x+\",\"+this.y+\") scale(\"+this.k+\")\"}},new r(1,0,0),r.prototype},1902(t,e,n){Math.cos,Math.sin,Math.PI,Math.max},1927(t,e,n){n.d(e,{Ay:()=>B,LN:()=>P,zr:()=>E});var r=n(7787),i=n(1348),o=n(9721),a=n(875),s=n(7365),l=n(355),u=n(6451),h=n(3207),c=n(267),d=n(2631),f=n(7971),p=n(2),g=n(8615),m=n(9918),v=n(8958),y=n(5766),w=n(7644),b=n(7626),A=n(8198),_=n(4470),S=n(1848),x=n(4026),C=n(6723),N=n(4954),k=n(7515),H=n(9450),F=n(9115),L=n(7778),R=n(8340),T=n(2454),M=n(3593),E=[null];function P(t,e){this._groups=t,this._parents=e}function W(){return new P([[document.documentElement]],E)}P.prototype=W.prototype={constructor:P,select:r.A,selectAll:i.A,filter:o.A,data:a.A,enter:s.A,exit:l.A,join:u.A,merge:h.A,order:c.A,sort:d.A,call:f.A,nodes:p.A,node:g.A,size:m.A,empty:v.A,each:y.A,attr:w.A,style:b.A,property:A.A,classed:_.A,text:S.A,html:x.A,raise:C.A,lower:N.A,append:k.A,insert:H.A,remove:F.A,clone:L.A,datum:R.A,on:T.Ay,dispatch:M.A};const B=W},2011(t,e,n){n(6479),n(481),n(3176),n(1831),n(8900)},2285(t,e,n){n(1363),n(2691),n(4685),n(7119)},2362(t,e,n){n.d(e,{A:()=>f});var r=n(2608),i=n(6357),o=n(478),a=n(4938);function s(t){return function(){this.removeAttribute(t)}}function l(t){return function(){this.removeAttributeNS(t.space,t.local)}}function u(t,e,n){var r,i,o=n+\"\";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=e(r=a,n)}}function h(t,e,n){var r,i,o=n+\"\";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=e(r=a,n)}}function c(t,e,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttribute(t))===(s=l+\"\")?null:a===r&&s===i?o:(i=s,o=e(r=a,l));this.removeAttribute(t)}}function d(t,e,n){var r,i,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttributeNS(t.space,t.local))===(s=l+\"\")?null:a===r&&s===i?o:(i=s,o=e(r=a,l));this.removeAttributeNS(t.space,t.local)}}function f(t,e){var n=(0,i.A)(t),f=\"transform\"===n?r.I:a.A;return this.attrTween(t,\"function\"==typeof e?(n.local?d:c)(n,f,(0,o.J)(this,\"attr.\"+t,e)):null==e?(n.local?l:s)(n):(n.local?h:u)(n,f,e))}},2385(t,e,n){!function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n}(n(6805).A)},2415(t,e,n){n.d(e,{$t:()=>f,CT:()=>o,Jo:()=>a,Ni:()=>d,Yo:()=>i,cR:()=>r});var r,i,o,a,s=n(6373),l=n(4),u=n(3424),h=n(7737),c=n(9278),d=1e-6,f=1e-12;function p(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function g(t,e){return e[1]-t[1]||e[0]-t[0]}function m(t,e){var n,d,f,p=t.sort(g).pop();for(a=[],i=new Array(t.length),r=new c.A,o=new c.A;;)if(f=u.Rg,p&&(!f||p[1]<f.y||p[1]===f.y&&p[0]<f.x))p[0]===n&&p[1]===d||((0,s.f)(p),n=p[0],d=p[1]),p=t.pop();else{if(!f)break;(0,s.G)(f.arc)}if((0,l.UO)(),e){var m=+e[0][0],v=+e[0][1],y=+e[1][0],w=+e[1][1];(0,h.$e)(m,v,y,w),(0,l.Oc)(m,v,y,w)}this.edges=a,this.cells=i,r=o=a=i=null}m.prototype={constructor:m,polygons:function(){var t=this.edges;return this.cells.map(function(e){var n=e.halfedges.map(function(n){return(0,l.Bb)(e,t[n])});return n.data=e.site.data,n})},triangles:function(){var t=[],e=this.edges;return this.cells.forEach(function(n,r){if(o=(i=n.halfedges).length)for(var i,o,a,s=n.site,l=-1,u=e[i[o-1]],h=u.left===s?u.right:u.left;++l<o;)a=h,h=(u=e[i[l]]).left===s?u.right:u.left,a&&h&&r<a.index&&r<h.index&&p(s,a,h)<0&&t.push([s.data,a.data,h.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,e,n){for(var r,i,o=this,a=o._found||0,s=o.cells.length;!(i=o.cells[a]);)if(++a>=s)return null;var l=t-i.site[0],u=e-i.site[1],h=l*l+u*u;do{i=o.cells[r=a],a=null,i.halfedges.forEach(function(n){var r=o.edges[n],s=r.left;if(s!==i.site&&s||(s=r.right)){var l=t-s[0],u=e-s[1],c=l*l+u*u;c<h&&(h=c,a=s.index)}})}while(null!==a);return o._found=r,null==n||h<=n*n?i.site:null}}},2454(t,e,n){n.d(e,{Ay:()=>u});var r={},i=null;function o(t,e,n){return t=a(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function a(t,e,n){return function(r){var o=i;i=r;try{t.call(this,this.__data__,e,n)}finally{i=o}}}function s(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function l(t,e,n){var i=r.hasOwnProperty(t.type)?o:a;return function(r,o,a){var s,l=this.__on,u=i(e,o,a);if(l)for(var h=0,c=l.length;h<c;++h)if((s=l[h]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=u,s.capture=n),void(s.value=e);this.addEventListener(t.type,u,n),s={type:t.type,name:t.name,value:e,listener:u,capture:n},l?l.push(s):this.__on=[s]}}function u(t,e,n){var r,i,o=function(t){return t.trim().split(/^|\\s+/).map(function(t){var e=\"\",n=t.indexOf(\".\");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}(t+\"\"),a=o.length;if(!(arguments.length<2)){for(u=e?l:s,null==n&&(n=!1),r=0;r<a;++r)this.each(u(o[r],e,n));return this}var u=this.node().__on;if(u)for(var h,c=0,d=u.length;c<d;++c)for(r=0,h=u[c];r<a;++r)if((i=o[r]).type===h.type&&i.name===h.name)return h.value}\"undefined\"!=typeof document&&(\"onmouseenter\"in document.documentElement||(r={mouseenter:\"mouseover\",mouseleave:\"mouseout\"}))},2492(t,e,n){n.d(e,{Ay:()=>c,Jt:()=>p,Op:()=>u,Ts:()=>d,hV:()=>h,hZ:()=>f,xo:()=>l});var r=n(2996),i=n(4036),o=n(114),a=(0,r.A)(\"start\",\"end\",\"cancel\",\"interrupt\"),s=[],l=2,u=5,h=6;function c(t,e,n,r,c,d){var f=t.__transition;if(f){if(n in f)return}else t.__transition={};!function(t,e,n){var r,a=t.__transition;function s(i){var u,f,p,g;if(1!==n.state)return d();for(u in a)if((g=a[u]).name===n.name){if(3===g.state)return(0,o.A)(s);4===g.state?(g.state=h,g.timer.stop(),g.on.call(\"interrupt\",t,t.__data__,g.index,g.group),delete a[u]):+u<e&&(g.state=h,g.timer.stop(),g.on.call(\"cancel\",t,t.__data__,g.index,g.group),delete a[u])}if((0,o.A)(function(){3===n.state&&(n.state=4,n.timer.restart(c,n.delay,n.time),c(i))}),n.state=l,n.on.call(\"start\",t,t.__data__,n.index,n.group),n.state===l){for(n.state=3,r=new Array(p=n.tween.length),u=0,f=-1;u<p;++u)(g=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++f]=g);r.length=f+1}}function c(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(d),n.state=u,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);n.state===u&&(n.on.call(\"end\",t,t.__data__,n.index,n.group),d())}function d(){for(var r in n.state=h,n.timer.stop(),delete a[e],a)return;delete t.__transition}a[e]=n,n.timer=(0,i.O1)(function(t){n.state=1,n.timer.restart(s,n.delay,n.time),n.delay<=t&&s(t-n.delay)},0,n.time)}(t,n,{name:e,index:r,group:c,on:a,tween:s,time:d.time,delay:d.delay,duration:d.duration,ease:d.ease,timer:null,state:0})}function d(t,e){var n=p(t,e);if(n.state>0)throw new Error(\"too late; already scheduled\");return n}function f(t,e){var n=p(t,e);if(n.state>3)throw new Error(\"too late; already running\");return n}function p(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error(\"transition not found\");return n}},2608(t,e,n){n.d(e,{I:()=>s,T:()=>a});var r=n(5566),i=n(499);function o(t,e,n,i){function o(t){return t.length?t.pop()+\" \":\"\"}return function(a,s){var l=[],u=[];return a=t(a),s=t(s),function(t,i,o,a,s,l){if(t!==o||i!==a){var u=s.push(\"translate(\",null,e,null,n);l.push({i:u-4,x:(0,r.A)(t,o)},{i:u-2,x:(0,r.A)(i,a)})}else(o||a)&&s.push(\"translate(\"+o+e+a+n)}(a.translateX,a.translateY,s.translateX,s.translateY,l,u),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(o(n)+\"rotate(\",null,i)-2,x:(0,r.A)(t,e)})):e&&n.push(o(n)+\"rotate(\"+e+i)}(a.rotate,s.rotate,l,u),function(t,e,n,a){t!==e?a.push({i:n.push(o(n)+\"skewX(\",null,i)-2,x:(0,r.A)(t,e)}):e&&n.push(o(n)+\"skewX(\"+e+i)}(a.skewX,s.skewX,l,u),function(t,e,n,i,a,s){if(t!==n||e!==i){var l=a.push(o(a)+\"scale(\",null,\",\",null,\")\");s.push({i:l-4,x:(0,r.A)(t,n)},{i:l-2,x:(0,r.A)(e,i)})}else 1===n&&1===i||a.push(o(a)+\"scale(\"+n+\",\"+i+\")\")}(a.scaleX,a.scaleY,s.scaleX,s.scaleY,l,u),a=s=null,function(t){for(var e,n=-1,r=u.length;++n<r;)l[(e=u[n]).i]=e.x(t);return l.join(\"\")}}}var a=o(i.P,\"px, \",\"px)\",\"deg)\"),s=o(i.i,\", \",\")\",\")\")},2631(t,e,n){n.d(e,{A:()=>i});var r=n(1927);function i(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=o);for(var n=this._groups,i=n.length,a=new Array(i),s=0;s<i;++s){for(var l,u=n[s],h=u.length,c=a[s]=new Array(h),d=0;d<h;++d)(l=u[d])&&(c[d]=l);c.sort(e)}return new r.LN(a,this._parents).order()}function o(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}},2684(t,e,n){function r(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}n.d(e,{A:()=>r})},2691(t,e,n){n(1508),n(1363),n(7119)},2765(t,e,n){},2794(t,e,n){!function t(e){function n(t){return function(){return-Math.log(1-e())/t}}return n.source=t,n}(n(6805).A)},2887(t,e,n){function r(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}n.d(e,{A:()=>r})},2930(t,e,n){var r=n(6805),i=n(837);!function t(e){function n(t){var n=i.A.source(e)(t);return function(){return n()/t}}return n.source=t,n}(r.A)},2996(t,e,n){n.d(e,{A:()=>l});var r={value:function(){}};function i(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+\"\")||t in r||/[\\s.]/.test(t))throw new Error(\"illegal type: \"+t);r[t]=[]}return new o(r)}function o(t){this._=t}function a(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function s(t,e,n){for(var i=0,o=t.length;i<o;++i)if(t[i].name===e){t[i]=r,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}o.prototype=i.prototype={constructor:o,on:function(t,e){var n,r,i=this._,o=(r=i,(t+\"\").trim().split(/^|\\s+/).map(function(t){var e=\"\",n=t.indexOf(\".\");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error(\"unknown type: \"+t);return{type:t,name:e}})),l=-1,u=o.length;if(!(arguments.length<2)){if(null!=e&&\"function\"!=typeof e)throw new Error(\"invalid callback: \"+e);for(;++l<u;)if(n=(t=o[l]).type)i[n]=s(i[n],t.name,e);else if(null==e)for(n in i)i[n]=s(i[n],t.name,null);return this}for(;++l<u;)if((n=(t=o[l]).type)&&(n=a(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new o(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error(\"unknown type: \"+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error(\"unknown type: \"+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};const l=i},3029(t,e,n){function r(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}function i(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),o=t[i],a=t[i+1],s=i>0?t[i-1]:2*o-a,l=i<e-1?t[i+2]:2*a-o;return r((n-i/e)*e,s,o,a,l)}}n.d(e,{A:()=>i,H:()=>r})},3103(t,e,n){n(8310)},3105(t,e,n){n.d(e,{Si:()=>C,eB:()=>x});var r=n(1927),i=n(2362),o=n(5079),a=n(8326),s=n(8625),l=n(8279),u=n(8035),h=n(4229),c=n(7360),d=n(8569),f=n(8653),p=n(9650),g=n(3683),m=n(7588),v=n(4101),y=n(6378),w=n(103),b=n(5170),A=n(478),_=n(9724),S=0;function x(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function C(){return++S}var N=r.Ay.prototype;x.prototype=function(t){return(0,r.Ay)().transition(t)}.prototype={constructor:x,select:f.A,selectAll:p.A,filter:u.A,merge:h.A,selection:g.A,transition:b.A,call:N.call,nodes:N.nodes,node:N.node,size:N.size,empty:N.empty,each:N.each,on:c.A,attr:i.A,attrTween:o.A,style:m.A,styleTween:v.A,text:y.A,textTween:w.A,remove:d.A,tween:A.A,delay:a.A,duration:s.A,ease:l.A,end:_.A}},3176(t,e,n){n(2285),n(6479)},3207(t,e,n){n.d(e,{A:()=>i});var r=n(1927);function i(t){for(var e=this._groups,n=t._groups,i=e.length,o=n.length,a=Math.min(i,o),s=new Array(i),l=0;l<a;++l)for(var u,h=e[l],c=n[l],d=h.length,f=s[l]=new Array(d),p=0;p<d;++p)(u=h[p]||c[p])&&(f[p]=u);for(;l<i;++l)s[l]=e[l];return new r.LN(s,this._parents)}},3274(t,e,n){n(1384),n(920)},3318(t,e,n){n.d(e,{A:()=>a});var r=n(5566),i=/[-+]?(?:\\d+\\.?\\d*|\\.?\\d+)(?:[eE][-+]?\\d+)?/g,o=new RegExp(i.source,\"g\");function a(t,e){var n,a,s,l=i.lastIndex=o.lastIndex=0,u=-1,h=[],c=[];for(t+=\"\",e+=\"\";(n=i.exec(t))&&(a=o.exec(e));)(s=a.index)>l&&(s=e.slice(l,s),h[u]?h[u]+=s:h[++u]=s),(n=n[0])===(a=a[0])?h[u]?h[u]+=a:h[++u]=a:(h[++u]=null,c.push({i:u,x:(0,r.A)(n,a)})),l=o.lastIndex;return l<e.length&&(s=e.slice(l),h[u]?h[u]+=s:h[++u]=s),h.length<2?c[0]?function(t){return function(e){return t(e)+\"\"}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,r=0;r<e;++r)h[(n=c[r]).i]=n.x(t);return h.join(\"\")})}},3424(t,e,n){n.d(e,{An:()=>l,Rg:()=>r,oq:()=>u});var r,i=n(9278),o=n(2415),a=[];function s(){(0,i.T)(this),this.x=this.y=this.arc=this.site=this.cy=null}function l(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,l=t.site,u=n.site;if(i!==u){var h=l[0],c=l[1],d=i[0]-h,f=i[1]-c,p=u[0]-h,g=u[1]-c,m=2*(d*g-f*p);if(!(m>=-o.$t)){var v=d*d+f*f,y=p*p+g*g,w=(g*v-f*y)/m,b=(d*y-p*v)/m,A=a.pop()||new s;A.arc=t,A.site=l,A.x=w+h,A.y=(A.cy=b+c)+Math.sqrt(w*w+b*b),t.circle=A;for(var _=null,S=o.CT._;S;)if(A.y<S.y||A.y===S.y&&A.x<=S.x){if(!S.L){_=S.P;break}S=S.L}else{if(!S.R){_=S;break}S=S.R}o.CT.insert(_,A),_||(r=A)}}}}function u(t){var e=t.circle;e&&(e.P||(r=e.N),o.CT.remove(e),a.push(e),(0,i.T)(e),t.circle=null)}},3593(t,e,n){n.d(e,{A:()=>s});var r=n(2684);function i(t,e,n){var i=(0,r.A)(t),o=i.CustomEvent;\"function\"==typeof o?o=new o(e,n):(o=i.document.createEvent(\"Event\"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function o(t,e){return function(){return i(this,t,e)}}function a(t,e){return function(){return i(this,t,e.apply(this,arguments))}}function s(t,e){return this.each((\"function\"==typeof e?a:o)(t,e))}},3683(t,e,n){n.d(e,{A:()=>i});var r=n(1927).Ay.prototype.constructor;function i(){return new r(this._groups,this._parents)}},3844(t,e,n){n.d(e,{Ay:()=>b,Qh:()=>S});var r=n(7592);function i(){}var o=.7,a=1/o,s=\"\\\\s*([+-]?\\\\d+)\\\\s*\",l=\"\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*\",u=\"\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*\",h=/^#([0-9a-f]{3,8})$/,c=new RegExp(\"^rgb\\\\(\"+[s,s,s]+\"\\\\)$\"),d=new RegExp(\"^rgb\\\\(\"+[u,u,u]+\"\\\\)$\"),f=new RegExp(\"^rgba\\\\(\"+[s,s,s,l]+\"\\\\)$\"),p=new RegExp(\"^rgba\\\\(\"+[u,u,u,l]+\"\\\\)$\"),g=new RegExp(\"^hsl\\\\(\"+[l,u,u]+\"\\\\)$\"),m=new RegExp(\"^hsla\\\\(\"+[l,u,u,l]+\"\\\\)$\"),v={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function y(){return this.rgb().formatHex()}function w(){return this.rgb().formatRgb()}function b(t){var e,n;return t=(t+\"\").trim().toLowerCase(),(e=h.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?A(e):3===n?new x(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?_(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?_(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=c.exec(t))?new x(e[1],e[2],e[3],1):(e=d.exec(t))?new x(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=f.exec(t))?_(e[1],e[2],e[3],e[4]):(e=p.exec(t))?_(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=g.exec(t))?H(e[1],e[2]/100,e[3]/100,1):(e=m.exec(t))?H(e[1],e[2]/100,e[3]/100,e[4]):v.hasOwnProperty(t)?A(v[t]):\"transparent\"===t?new x(NaN,NaN,NaN,0):null}function A(t){return new x(t>>16&255,t>>8&255,255&t,1)}function _(t,e,n,r){return r<=0&&(t=e=n=NaN),new x(t,e,n,r)}function S(t,e,n,r){return 1===arguments.length?((o=t)instanceof i||(o=b(o)),o?new x((o=o.rgb()).r,o.g,o.b,o.opacity):new x):new x(t,e,n,null==r?1:r);var o}function x(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function C(){return\"#\"+k(this.r)+k(this.g)+k(this.b)}function N(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?\"rgb(\":\"rgba(\")+Math.max(0,Math.min(255,Math.round(this.r)||0))+\", \"+Math.max(0,Math.min(255,Math.round(this.g)||0))+\", \"+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?\")\":\", \"+t+\")\")}function k(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?\"0\":\"\")+t.toString(16)}function H(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new L(t,e,n,r)}function F(t){if(t instanceof L)return new L(t.h,t.s,t.l,t.opacity);if(t instanceof i||(t=b(t)),!t)return new L;if(t instanceof L)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,o=Math.min(e,n,r),a=Math.max(e,n,r),s=NaN,l=a-o,u=(a+o)/2;return l?(s=e===a?(n-r)/l+6*(n<r):n===a?(r-e)/l+2:(e-n)/l+4,l/=u<.5?a+o:2-a-o,s*=60):l=u>0&&u<1?0:s,new L(s,l,u,t.opacity)}function L(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function R(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}(0,r.A)(i,b,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:y,formatHex:y,formatHsl:function(){return F(this).formatHsl()},formatRgb:w,toString:w}),(0,r.A)(x,S,(0,r.X)(i,{brighter:function(t){return t=null==t?a:Math.pow(a,t),new x(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?o:Math.pow(o,t),new x(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:C,formatHex:C,formatRgb:N,toString:N})),(0,r.A)(L,function(t,e,n,r){return 1===arguments.length?F(t):new L(t,e,n,null==r?1:r)},(0,r.X)(i,{brighter:function(t){return t=null==t?a:Math.pow(a,t),new L(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?o:Math.pow(o,t),new L(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new x(R(t>=240?t-240:t+120,i,r),R(t,i,r),R(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?\"hsl(\":\"hsla(\")+(this.h||0)+\", \"+100*(this.s||0)+\"%, \"+100*(this.l||0)+\"%\"+(1===t?\")\":\", \"+t+\")\")}}))},4026(t,e,n){function r(){this.innerHTML=\"\"}function i(t){return function(){this.innerHTML=t}}function o(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?\"\":e}}function a(t){return arguments.length?this.each(null==t?r:(\"function\"==typeof t?o:i)(t)):this.node().innerHTML}n.d(e,{A:()=>a})},4036(t,e,n){n.d(e,{M4:()=>g,O1:()=>m,tB:()=>f});var r,i,o=0,a=0,s=0,l=0,u=0,h=0,c=\"object\"==typeof performance&&performance.now?performance:Date,d=\"object\"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function f(){return u||(d(p),u=c.now()+h)}function p(){u=0}function g(){this._call=this._time=this._next=null}function m(t,e,n){var r=new g;return r.restart(t,e,n),r}function v(){u=(l=c.now())+h,o=a=0;try{!function(){f(),++o;for(var t,e=r;e;)(t=u-e._time)>=0&&e._call.call(null,t),e=e._next;--o}()}finally{o=0,function(){for(var t,e,n=r,o=1/0;n;)n._call?(o>n._time&&(o=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:r=e);i=t,w(o)}(),u=0}}function y(){var t=c.now(),e=t-l;e>1e3&&(h-=e,l=t)}function w(t){o||(a&&(a=clearTimeout(a)),t-u>24?(t<1/0&&(a=setTimeout(v,t-c.now()-h)),s&&(s=clearInterval(s))):(s||(l=c.now(),s=setInterval(y,1e3)),o=1,d(v)))}g.prototype=m.prototype={constructor:g,restart:function(t,e,n){if(\"function\"!=typeof t)throw new TypeError(\"callback is not a function\");n=(null==n?f():+n)+(null==e?0:+e),this._next||i===this||(i?i._next=this:r=this,i=this),this._call=t,this._time=n,w()},stop:function(){this._call&&(this._call=null,this._time=1/0,w())}}},4101(t,e,n){function r(t,e,n){var r=\"style.\"+(t+=\"\");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if(\"function\"!=typeof e)throw new Error;return this.tween(r,function(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&function(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}(t,o,n)),r}return o._value=e,o}(t,e,null==n?\"\":n))}n.d(e,{A:()=>r})},4124(t,e,n){n.d(e,{x:()=>r});class r{constructor(){this.matrixDataView=null,this.valueColumns=[],this.rowLevels=0,this.columnLevels=0}processDataView(t,e){this.matrixDataView=t,t.valueRoot?.children&&(this.valueColumns=t.valueRoot.children),this.rowLevels=t.rows?.levels?.length||0,this.columnLevels=t.columns?.levels?.length||0}getRowHierarchy(t){return this.matrixDataView?.rows?.root?this.buildRowHierarchy(this.matrixDataView.rows.root,0,[],t):[]}getColumnHierarchy(t){if(!this.matrixDataView?.columns?.root)return[];const e=this.buildColumnHierarchy(this.matrixDataView.columns.root,0,[],t);return this.addValueColumnsToColumns(e)}buildRowHierarchy(t,e,n,r){const i=[...n,t.value?.toString()||\"\"],o=i.join(\"|\"),a=r.get(o)??(t.children&&t.children.length>0),s={node:t,level:e,path:i,isExpanded:!!a,isSubtotal:!!t.isSubtotal,children:[],indentLevel:e};if(a&&t.children)for(const n of t.children)this.buildRowHierarchy(n,e+1,i,r).forEach(t=>{t.parent=s,s.children.push(t)});return[s]}buildColumnHierarchy(t,e,n,r){const i=[...n,t.value?.toString()||\"\"],o=i.join(\"|\"),a=r.get(o)??(t.children&&t.children.length>0),s={node:t,level:e,path:i,isExpanded:!!a,children:[]};if(a&&t.children)for(const n of t.children)this.buildColumnHierarchy(n,e+1,i,r).forEach(t=>{t.parent=s,s.children.push(t)});return[s]}addValueColumnsToColumns(t){const e=[];for(const n of t)if(0===n.children.length)for(let t=0;t<this.valueColumns.length;t++)e.push({...n,valueColumnIndex:t,children:[]});else{const t=this.addValueColumnsToColumns(n.children);e.push({...n,children:t})}return e}getFlattenedRows(t){const e=[];for(const n of t)e.push(n),n.isExpanded&&n.children.length>0&&e.push(...this.getFlattenedRows(n.children));return e}getFlattenedColumns(t){const e=[];for(const n of t)e.push(n),n.isExpanded&&n.children.length>0&&e.push(...this.getFlattenedColumns(n.children));return e}getCellValue(t,e,n){if(!this.matrixDataView?.rows?.root)return null;const r=this.findNodeByPath(this.matrixDataView.rows.root,t);if(!r||!r.values)return null;const i=r.values;if(!i)return null;const o=[];this.matrixDataView.columns?.root&&this.collectAllColumnPaths(this.matrixDataView.columns.root,[],o);let a=-1;for(let t=0;t<o.length;t++){const r=o[t];if(this.pathsMatch(r.path,e)&&r.valueIndex===n){a=t;break}}if(a<0)return null;const s=i[a];if(null==s)return null;const l=\"number\"==typeof s?s:parseFloat(s.toString())||null;return{rowPath:t,columnPath:e,value:l,formattedValue:this.formatValue(l,n),valueColumnIndex:n}}findNodeByPath(t,e){if(0===e.length)return t;const n=t.value?.toString()||\"\";if(e[0]===n){if(1===e.length)return t;if(t.children)for(const n of t.children){const t=this.findNodeByPath(n,e.slice(1));if(t)return t}}return null}collectAllColumnPaths(t,e,n){const r=[...e,t.value?.toString()||\"\"];if(t.children&&0!==t.children.length)for(const e of t.children)this.collectAllColumnPaths(e,r,n);else for(let t=0;t<this.valueColumns.length;t++)n.push({path:r,valueIndex:t})}pathsMatch(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}formatValue(t,e){if(null===t)return\"\";if(this.valueColumns&&this.valueColumns.length>e){const n=this.valueColumns[e],r=n.source?.format;if(r)return this.applyFormat(t,r)}return t.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}applyFormat(t,e){if(e.includes(\"$\")||e.includes(\"€\")||e.includes(\"£\"))return t.toLocaleString(void 0,{style:\"currency\",currency:\"USD\",minimumFractionDigits:2,maximumFractionDigits:2});const n=e.match(/\\.(0+)/);if(n){const e=n[1].length;return t.toLocaleString(void 0,{minimumFractionDigits:e,maximumFractionDigits:e})}return t.toLocaleString()}getValueColumns(){return this.valueColumns}getRowLevels(){return this.rowLevels}getColumnLevels(){return this.columnLevels}}},4229(t,e,n){n.d(e,{A:()=>i});var r=n(3105);function i(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,o=n.length,a=Math.min(i,o),s=new Array(i),l=0;l<a;++l)for(var u,h=e[l],c=n[l],d=h.length,f=s[l]=new Array(d),p=0;p<d;++p)(u=h[p]||c[p])&&(f[p]=u);for(;l<i;++l)s[l]=e[l];return new r.eB(s,this._parents,this._name,this._id)}},4299(t,e,n){n.d(e,{A:()=>i});var r=n(6038);function i(t){return this.each(function(){(0,r.A)(this,t)})}},4425(t,e,n){n.d(e,{A:()=>i});var r=n(3029);function i(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),o=t[(i+e-1)%e],a=t[i%e],s=t[(i+1)%e],l=t[(i+2)%e];return(0,r.H)((n-i/e)*e,o,a,s,l)}}},4470(t,e,n){function r(t){return t.trim().split(/^|\\s+/)}function i(t){return t.classList||new o(t)}function o(t){this._node=t,this._names=r(t.getAttribute(\"class\")||\"\")}function a(t,e){for(var n=i(t),r=-1,o=e.length;++r<o;)n.add(e[r])}function s(t,e){for(var n=i(t),r=-1,o=e.length;++r<o;)n.remove(e[r])}function l(t){return function(){a(this,t)}}function u(t){return function(){s(this,t)}}function h(t,e){return function(){(e.apply(this,arguments)?a:s)(this,t)}}function c(t,e){var n=r(t+\"\");if(arguments.length<2){for(var o=i(this.node()),a=-1,s=n.length;++a<s;)if(!o.contains(n[a]))return!1;return!0}return this.each((\"function\"==typeof e?h:e?l:u)(n,e))}n.d(e,{A:()=>c}),o.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute(\"class\",this._names.join(\" \")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute(\"class\",this._names.join(\" \")))},contains:function(t){return this._names.indexOf(t)>=0}}},4685(t,e,n){n(1508)},4692(t,e,n){function r(t){return function(){return this.matches(t)}}n.d(e,{A:()=>r})},4725(t,e,n){n(2285),n(6911),n(6479)},4735(t,e,n){n.d(e,{O:()=>r});class r{constructor(){this.rowHeaderSettings={fontFamily:\"Segoe UI\",fontSize:11,fontColor:\"#212121\",backgroundColor:\"#ffffff\",wordWrap:!1,alignment:\"left\",border:!0},this.columnHeaderSettings={fontFamily:\"Segoe UI\",fontSize:11,fontColor:\"#212121\",backgroundColor:\"#f8f8f8\",wordWrap:!1,alignment:\"center\",border:!0},this.valueSettings={fontFamily:\"Segoe UI\",fontSize:11,fontColor:\"#212121\",backgroundColor:\"#ffffff\",alignment:\"right\",numberFormat:\"#,##0.00\",decimalPlaces:2,conditionalFormatting:\"none\"},this.gridSettings={gridlines:!0,horizontalGridlines:!0,verticalGridlines:!0,rowBanding:!1,columnBanding:!1,bandingColor:\"#f5f5f5\",padding:8,outlineStyle:\"stepped\"},this.totalsSettings={showRowSubtotals:!0,showColumnSubtotals:!0,showRowGrandTotals:!0,showColumnGrandTotals:!0,subtotalFontFamily:\"Segoe UI\",subtotalFontSize:11,subtotalFontColor:\"#212121\",subtotalBackgroundColor:\"#f0f0f0\",grandTotalFontFamily:\"Segoe UI\",grandTotalFontSize:11,grandTotalFontColor:\"#212121\",grandTotalBackgroundColor:\"#e0e0e0\",subtotalSettings:{fontFamily:\"Segoe UI\",fontSize:11,fontColor:\"#212121\",backgroundColor:\"#f0f0f0\",alignment:\"left\"},grandTotalSettings:{fontFamily:\"Segoe UI\",fontSize:11,fontColor:\"#212121\",backgroundColor:\"#e0e0e0\",alignment:\"left\"}},this.sortingSettings={sortBy:\"hierarchy\",sortDirection:\"asc\"}}update(t){if(!t||0===t.length)return;const e=t[0];if(!e.metadata||!e.metadata.objects)return;const n=e.metadata.objects;n.rowHeaders&&this.updateRowHeaderSettings(n.rowHeaders),n.columnHeaders&&this.updateColumnHeaderSettings(n.columnHeaders),n.values&&this.updateValueSettings(n.values),n.grid&&this.updateGridSettings(n.grid),n.totals&&this.updateTotalsSettings(n.totals),n.sorting&&this.updateSortingSettings(n.sorting)}updateRowHeaderSettings(t){t.fontFamily&&(this.rowHeaderSettings.fontFamily=t.fontFamily),t.fontSize&&(this.rowHeaderSettings.fontSize=t.fontSize),t.fontColor&&(this.rowHeaderSettings.fontColor=t.fontColor.solid.color),t.backgroundColor&&(this.rowHeaderSettings.backgroundColor=t.backgroundColor.solid.color),void 0!==t.wordWrap&&(this.rowHeaderSettings.wordWrap=t.wordWrap),t.alignment&&(this.rowHeaderSettings.alignment=t.alignment),void 0!==t.border&&(this.rowHeaderSettings.border=t.border)}updateColumnHeaderSettings(t){t.fontFamily&&(this.columnHeaderSettings.fontFamily=t.fontFamily),t.fontSize&&(this.columnHeaderSettings.fontSize=t.fontSize),t.fontColor&&(this.columnHeaderSettings.fontColor=t.fontColor.solid.color),t.backgroundColor&&(this.columnHeaderSettings.backgroundColor=t.backgroundColor.solid.color),void 0!==t.wordWrap&&(this.columnHeaderSettings.wordWrap=t.wordWrap),t.alignment&&(this.columnHeaderSettings.alignment=t.alignment),void 0!==t.border&&(this.columnHeaderSettings.border=t.border)}updateValueSettings(t){t.fontFamily&&(this.valueSettings.fontFamily=t.fontFamily),t.fontSize&&(this.valueSettings.fontSize=t.fontSize),t.fontColor&&(this.valueSettings.fontColor=t.fontColor.solid.color),t.backgroundColor&&(this.valueSettings.backgroundColor=t.backgroundColor.solid.color),t.alignment&&(this.valueSettings.alignment=t.alignment),t.numberFormat&&(this.valueSettings.numberFormat=t.numberFormat),void 0!==t.decimalPlaces&&(this.valueSettings.decimalPlaces=t.decimalPlaces),t.conditionalFormatting&&(this.valueSettings.conditionalFormatting=t.conditionalFormatting)}updateGridSettings(t){void 0!==t.gridlines&&(this.gridSettings.gridlines=t.gridlines),void 0!==t.horizontalGridlines&&(this.gridSettings.horizontalGridlines=t.horizontalGridlines),void 0!==t.verticalGridlines&&(this.gridSettings.verticalGridlines=t.verticalGridlines),void 0!==t.rowBanding&&(this.gridSettings.rowBanding=t.rowBanding),void 0!==t.columnBanding&&(this.gridSettings.columnBanding=t.columnBanding),t.bandingColor&&(this.gridSettings.bandingColor=t.bandingColor.solid.color),void 0!==t.padding&&(this.gridSettings.padding=t.padding),t.outlineStyle&&(this.gridSettings.outlineStyle=t.outlineStyle)}updateTotalsSettings(t){void 0!==t.showRowSubtotals&&(this.totalsSettings.showRowSubtotals=t.showRowSubtotals),void 0!==t.showColumnSubtotals&&(this.totalsSettings.showColumnSubtotals=t.showColumnSubtotals),void 0!==t.showRowGrandTotals&&(this.totalsSettings.showRowGrandTotals=t.showRowGrandTotals),void 0!==t.showColumnGrandTotals&&(this.totalsSettings.showColumnGrandTotals=t.showColumnGrandTotals),t.subtotalFontFamily&&(this.totalsSettings.subtotalFontFamily=t.subtotalFontFamily),t.subtotalFontSize&&(this.totalsSettings.subtotalFontSize=t.subtotalFontSize),t.subtotalFontColor&&(this.totalsSettings.subtotalFontColor=t.subtotalFontColor.solid.color),t.subtotalBackgroundColor&&(this.totalsSettings.subtotalBackgroundColor=t.subtotalBackgroundColor.solid.color),t.grandTotalFontFamily&&(this.totalsSettings.grandTotalFontFamily=t.grandTotalFontFamily),t.grandTotalFontSize&&(this.totalsSettings.grandTotalFontSize=t.grandTotalFontSize),t.grandTotalFontColor&&(this.totalsSettings.grandTotalFontColor=t.grandTotalFontColor.solid.color),t.grandTotalBackgroundColor&&(this.totalsSettings.grandTotalBackgroundColor=t.grandTotalBackgroundColor.solid.color)}updateSortingSettings(t){t.sortBy&&(this.sortingSettings.sortBy=t.sortBy),t.sortDirection&&(this.sortingSettings.sortDirection=t.sortDirection)}enumerateObjectInstances(t){const e=[];switch(t.objectName){case\"rowHeaders\":e.push({objectName:\"rowHeaders\",properties:{fontFamily:this.rowHeaderSettings.fontFamily,fontSize:this.rowHeaderSettings.fontSize,fontColor:{solid:{color:this.rowHeaderSettings.fontColor}},backgroundColor:{solid:{color:this.rowHeaderSettings.backgroundColor}},wordWrap:this.rowHeaderSettings.wordWrap,alignment:this.rowHeaderSettings.alignment,border:this.rowHeaderSettings.border},selector:null});break;case\"columnHeaders\":e.push({objectName:\"columnHeaders\",properties:{fontFamily:this.columnHeaderSettings.fontFamily,fontSize:this.columnHeaderSettings.fontSize,fontColor:{solid:{color:this.columnHeaderSettings.fontColor}},backgroundColor:{solid:{color:this.columnHeaderSettings.backgroundColor}},wordWrap:this.columnHeaderSettings.wordWrap,alignment:this.columnHeaderSettings.alignment,border:this.columnHeaderSettings.border},selector:null});break;case\"values\":e.push({objectName:\"values\",properties:{fontFamily:this.valueSettings.fontFamily,fontSize:this.valueSettings.fontSize,fontColor:{solid:{color:this.valueSettings.fontColor}},backgroundColor:{solid:{color:this.valueSettings.backgroundColor}},alignment:this.valueSettings.alignment,numberFormat:this.valueSettings.numberFormat,decimalPlaces:this.valueSettings.decimalPlaces,conditionalFormatting:this.valueSettings.conditionalFormatting},selector:null});break;case\"grid\":e.push({objectName:\"grid\",properties:{gridlines:this.gridSettings.gridlines,horizontalGridlines:this.gridSettings.horizontalGridlines,verticalGridlines:this.gridSettings.verticalGridlines,rowBanding:this.gridSettings.rowBanding,columnBanding:this.gridSettings.columnBanding,bandingColor:{solid:{color:this.gridSettings.bandingColor}},padding:this.gridSettings.padding,outlineStyle:this.gridSettings.outlineStyle},selector:null});break;case\"totals\":e.push({objectName:\"totals\",properties:{showRowSubtotals:this.totalsSettings.showRowSubtotals,showColumnSubtotals:this.totalsSettings.showColumnSubtotals,showRowGrandTotals:this.totalsSettings.showRowGrandTotals,showColumnGrandTotals:this.totalsSettings.showColumnGrandTotals,subtotalFontFamily:this.totalsSettings.subtotalFontFamily,subtotalFontSize:this.totalsSettings.subtotalFontSize,subtotalFontColor:{solid:{color:this.totalsSettings.subtotalFontColor}},subtotalBackgroundColor:{solid:{color:this.totalsSettings.subtotalBackgroundColor}},grandTotalFontFamily:this.totalsSettings.grandTotalFontFamily,grandTotalFontSize:this.totalsSettings.grandTotalFontSize,grandTotalFontColor:{solid:{color:this.totalsSettings.grandTotalFontColor}},grandTotalBackgroundColor:{solid:{color:this.totalsSettings.grandTotalBackgroundColor}}},selector:null});break;case\"sorting\":e.push({objectName:\"sorting\",properties:{sortBy:this.sortingSettings.sortBy,sortDirection:this.sortingSettings.sortDirection},selector:null})}return e}getRowHeaderSettings(){return{...this.rowHeaderSettings}}getColumnHeaderSettings(){return{...this.columnHeaderSettings}}getValueSettings(){return{...this.valueSettings}}getGridSettings(){return{...this.gridSettings}}getTotalsSettings(){return{...this.totalsSettings}}getSortingSettings(){return{...this.sortingSettings}}}},4938(t,e,n){n.d(e,{A:()=>s});var r=n(3844),i=n(5566),o=n(3318),a=n(9948);function s(t,e){var n;return(\"number\"==typeof e?i.A:e instanceof r.Ay?a.Ay:(n=(0,r.Ay)(e))?(e=n,a.Ay):o.A)(t,e)}},4954(t,e,n){function r(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function i(){return this.each(r)}n.d(e,{A:()=>i})},5079(t,e,n){n.d(e,{A:()=>a});var r=n(6357);function i(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,i)),n}return i._value=e,i}function o(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,i)),n}return i._value=e,i}function a(t,e){var n=\"attr.\"+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if(\"function\"!=typeof e)throw new Error;var a=(0,r.A)(t);return this.tween(n,(a.local?i:o)(a,e))}},5122(t,e,n){n.d(e,{A:()=>i});var r=n(2887);function i(t){var e;return 1===t.length&&(e=t,t=function(t,n){return(0,r.A)(e(t),n)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}}},5128(t,e,n){var r=n(6805),i=n(6034);!function t(e){function n(){var t=i.A.source(e).apply(this,arguments);return function(){return Math.exp(t())}}return n.source=t,n}(r.A)},5170(t,e,n){n.d(e,{A:()=>o});var r=n(3105),i=n(2492);function o(){for(var t=this._name,e=this._id,n=(0,r.Si)(),o=this._groups,a=o.length,s=0;s<a;++s)for(var l,u=o[s],h=u.length,c=0;c<h;++c)if(l=u[c]){var d=(0,i.Jt)(l,e);(0,i.Ay)(l,t,n,c,u,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new r.eB(o,this._parents,t,n)}},5276(t,e,n){var r=n(1927),i=n(4299),o=n(7137);r.Ay.prototype.interrupt=i.A,r.Ay.prototype.transition=o.A},5278(t,e,n){n.d(e,{Lt:()=>r.A});var r=n(7204)},5566(t,e,n){function r(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}n.d(e,{A:()=>r})},5766(t,e,n){function r(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,s=o.length;a<s;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this}n.d(e,{A:()=>r})},5783(t,e,n){Array.prototype.slice},5789(t,e,n){n.d(e,{S:()=>s});var r=n(1272),i=n(4735),o=n(4124),a=n(9497);class s{constructor(t){if(this.expandCollapseState=new Map,!t)throw new Error(\"VisualConstructorOptions are required\");this.host=t.host,this.element=t.element,this.formattingSettings=new i.O,this.dataModel=new o.x,this.container=document.createElement(\"div\"),this.container.className=\"matrix-visual-container\",this.element.appendChild(this.container),this.renderingEngine=new a.v(this.container,this.host,this.expandCollapseState)}update(t){try{const e=t.dataViews?.[0];if(!e||!e.matrix)return void this.clearVisual();this.viewport={width:t.viewport.width,height:t.viewport.height},this.formattingSettings.update(t.dataViews),r.Ltv(this.container).selectAll(\"*\").remove();const n=r.Ltv(this.container).append(\"table\").style(\"border-collapse\",\"collapse\").style(\"width\",\"100%\").style(\"font-family\",\"Segoe UI, sans-serif\").style(\"font-size\",\"11px\"),i=n.append(\"thead\").append(\"tr\");i.append(\"th\").style(\"width\",\"200px\").style(\"padding\",\"8px\").style(\"border\",\"1px solid #ddd\").style(\"background-color\",\"#f8f8f8\").text(\"Hierarchy\"),e.matrix.columns&&e.matrix.columns.root&&this.buildColumnHeadersD3(i,e.matrix.columns.root,0);const o=n.append(\"tbody\");e.matrix.rows&&e.matrix.rows.root&&e.matrix.rows.root.children&&this.buildRowsD3(o,e.matrix.rows.root.children,0,e.matrix)}catch(t){console.error(\"Error updating visual:\",t),this.showError(\"Error rendering matrix visual\")}}enumerateObjectInstances(t){return this.formattingSettings.enumerateObjectInstances(t)}buildColumnHeadersD3(t,e,n){if(e.children&&e.children.length>0)for(const r of e.children)this.buildColumnHeadersD3(t,r,n+1);else t.append(\"th\").style(\"padding\",\"8px\").style(\"border\",\"1px solid #ddd\").style(\"background-color\",\"#f8f8f8\").style(\"text-align\",\"center\").style(\"font-weight\",\"600\").text(e.value?e.value.toString():\"\"),1===n&&(t.append(\"th\").style(\"padding\",\"8px\").style(\"border\",\"1px solid #ddd\").style(\"background-color\",\"#f8f8f8\").style(\"text-align\",\"center\").style(\"font-weight\",\"600\").text(\"Expense\"),t.append(\"th\").style(\"padding\",\"8px\").style(\"border\",\"1px solid #ddd\").style(\"background-color\",\"#f8f8f8\").style(\"text-align\",\"center\").style(\"font-weight\",\"600\").text(\"Revenue\"))}buildRowsD3(t,e,n,r){const i=t.selectAll(`.level-${n}`).data(e).enter().append(\"tr\").classed(`level-${n}`,!0);i.append(\"td\").style(\"padding\",\"8px\").style(\"border\",\"1px solid #ddd\").style(\"padding-left\",20*n+8+\"px\").text(t=>t.value?t.value.toString():\"\").filter(t=>!!(t.children&&t.children.length>0)).append(\"span\").style(\"margin-right\",\"5px\").style(\"cursor\",\"pointer\").text(t=>this.expandCollapseState.get(t.value?.toString()||\"\")?\"▼\":\"▶\").on(\"click\",(t,e)=>{const n=e.value?.toString()||\"\",r=this.expandCollapseState.get(n)??!1;this.expandCollapseState.set(n,!r),this.host.refreshHostData()}),r.columns&&r.columns.root&&this.addDataCellsD3(i,r.columns.root,r),e.forEach(e=>{e.children&&e.children.length>0&&(this.expandCollapseState.get(e.value?.toString()||\"\")??1)&&this.buildRowsD3(t,e.children,n+1,r)})}addDataCellsD3(t,e,n){if(e.children&&e.children.length>0)for(const r of e.children)this.addDataCellsD3(t,r,n);else t.each((t=>{const i=r.Ltv(this),o=this.getCellValue(t,e,0,n);i.append(\"td\").style(\"padding\",\"8px\").style(\"border\",\"1px solid #ddd\").style(\"text-align\",\"right\").text(o||\"\");const a=this.getCellValue(t,e,1,n);i.append(\"td\").style(\"padding\",\"8px\").style(\"border\",\"1px solid #ddd\").style(\"text-align\",\"right\").text(a||\"\")}).bind(this))}getCellValue(t,e,n,r){if(t.values&&t.values[n]){const e=t.values[n].value;return e?e.toString():null}return null}clearVisual(){this.container.innerHTML=\"\"}showError(t){this.container.innerHTML=`<div style=\"padding: 20px; color: #d13438;\">${t}</div>`}}},5800(t,e,n){n.d(e,{A:()=>a,P:()=>r});var r=\"$\";function i(){}function o(t,e){var n=new i;if(t instanceof i)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var r,o=-1,a=t.length;if(null==e)for(;++o<a;)n.set(o,t[o]);else for(;++o<a;)n.set(e(r=t[o],o,t),r)}else if(t)for(var s in t)n.set(s,t[s]);return n}i.prototype=o.prototype={constructor:i,has:function(t){return r+t in this},get:function(t){return this[r+t]},set:function(t,e){return this[r+t]=e,this},remove:function(t){var e=r+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===r&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===r&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===r&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===r&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===r&&++t;return t},empty:function(){for(var t in this)if(t[0]===r)return!1;return!0},each:function(t){for(var e in this)e[0]===r&&t(this[e],e.slice(1),this)}};const a=o},5889(t,e,n){n(6479),n(481),n(3176),n(2011),n(1831),n(8900)},6034(t,e,n){n.d(e,{A:()=>r});const r=function t(e){function n(t,n){var r,i;return t=null==t?0:+t,n=null==n?1:+n,function(){var o;if(null!=r)o=r,r=null;else do{r=2*e()-1,o=2*e()-1,i=r*r+o*o}while(!i||i>1);return t+n*o*Math.sqrt(-2*Math.log(i)/i)}}return n.source=t,n}(n(6805).A)},6038(t,e,n){n.d(e,{A:()=>i});var r=n(2492);function i(t,e){var n,i,o,a=t.__transition,s=!0;if(a){for(o in e=null==e?null:e+\"\",a)(n=a[o]).name===e?(i=n.state>r.xo&&n.state<r.Op,n.state=r.hV,n.timer.stop(),n.on.call(i?\"interrupt\":\"cancel\",t,t.__data__,n.index,n.group),delete a[o]):s=!1;s&&delete t.__transition}}},6100(t,e,n){function r(t){return{type:t}}n(8961),[\"w\",\"e\"].map(r),[\"n\",\"s\"].map(r),[\"n\",\"w\",\"e\",\"s\",\"nw\",\"ne\",\"sw\",\"se\"].map(r)},6357(t,e,n){n.d(e,{A:()=>i});var r=n(8176);function i(t){var e=t+=\"\",n=e.indexOf(\":\");return n>=0&&\"xmlns\"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),r.A.hasOwnProperty(e)?{space:r.A[e],local:t}:t}},6371(t,e,n){n(2285),n(6911),n(481)},6373(t,e,n){n.d(e,{G:()=>d,f:()=>f});var r=n(9278),i=n(4),o=n(3424),a=n(7737),s=n(2415),l=[];function u(){(0,r.T)(this),this.edge=this.site=this.circle=null}function h(t){var e=l.pop()||new u;return e.site=t,e}function c(t){(0,o.oq)(t),s.cR.remove(t),l.push(t),(0,r.T)(t)}function d(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],l=t.P,u=t.N,h=[t];c(t);for(var d=l;d.circle&&Math.abs(n-d.circle.x)<s.Ni&&Math.abs(r-d.circle.cy)<s.Ni;)l=d.P,h.unshift(d),c(d),d=l;h.unshift(d),(0,o.oq)(d);for(var f=u;f.circle&&Math.abs(n-f.circle.x)<s.Ni&&Math.abs(r-f.circle.cy)<s.Ni;)u=f.N,h.push(f),c(f),f=u;h.push(f),(0,o.oq)(f);var p,g=h.length;for(p=1;p<g;++p)f=h[p],d=h[p-1],(0,a.$Y)(f.edge,d.site,f.site,i);d=h[0],(f=h[g-1]).edge=(0,a.Qd)(d.site,f.site,null,i),(0,o.An)(d),(0,o.An)(f)}function f(t){for(var e,n,r,l,u=t[0],c=t[1],d=s.cR._;d;)if((r=p(d,c)-u)>s.Ni)d=d.L;else{if(!((l=u-g(d,c))>s.Ni)){r>-s.Ni?(e=d.P,n=d):l>-s.Ni?(e=d,n=d.N):e=n=d;break}if(!d.R){e=d;break}d=d.R}(0,i.P9)(t);var f=h(t);if(s.cR.insert(e,f),e||n){if(e===n)return(0,o.oq)(e),n=h(e.site),s.cR.insert(f,n),f.edge=n.edge=(0,a.Qd)(e.site,f.site),(0,o.An)(e),void(0,o.An)(n);if(n){(0,o.oq)(e),(0,o.oq)(n);var m=e.site,v=m[0],y=m[1],w=t[0]-v,b=t[1]-y,A=n.site,_=A[0]-v,S=A[1]-y,x=2*(w*S-b*_),C=w*w+b*b,N=_*_+S*S,k=[(S*C-b*N)/x+v,(w*N-_*C)/x+y];(0,a.$Y)(n.edge,m,A,k),f.edge=(0,a.Qd)(m,t,null,k),n.edge=(0,a.Qd)(t,A,null,k),(0,o.An)(e),(0,o.An)(n)}else f.edge=(0,a.Qd)(e.site,f.site)}}function p(t,e){var n=t.site,r=n[0],i=n[1],o=i-e;if(!o)return r;var a=t.P;if(!a)return-1/0;var s=(n=a.site)[0],l=n[1],u=l-e;if(!u)return s;var h=s-r,c=1/o-1/u,d=h/u;return c?(-d+Math.sqrt(d*d-2*c*(h*h/(-2*u)-l+u/2+i-o/2)))/c+r:(r+s)/2}function g(t,e){var n=t.N;if(n)return p(n,e);var r=t.site;return r[1]===e?r[0]:1/0}},6378(t,e,n){n.d(e,{A:()=>i});var r=n(478);function i(t){return this.tween(\"text\",\"function\"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?\"\":e}}((0,r.J)(this,\"text\",t)):function(t){return function(){this.textContent=t}}(null==t?\"\":t+\"\"))}},6451(t,e,n){function r(t,e,n){var r=this.enter(),i=this,o=this.exit();return r=\"function\"==typeof t?t(r):r.append(t+\"\"),null!=e&&(i=e(i)),null==n?o.remove():n(o),r&&i?r.merge(i).order():i}n.d(e,{A:()=>r})},6479(t,e,n){n(2285),n(6911)},6504(t,e,n){n.d(e,{Ay:()=>o,uN:()=>i});var r=n(319);function i(t){return 1===(t=+t)?o:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):(0,r.A)(isNaN(e)?n:e)}}function o(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):(0,r.A)(isNaN(t)?e:t)}},6527(t,e,n){n(1650),n(6911)},6690(t,e,n){n(8160)},6696(t,e,n){n(8440)},6698(t,e,n){n(2285)},6707(t,e,n){function r(t){return new Array(t.length)}n.d(e,{A:()=>r})},6723(t,e,n){function r(){this.nextSibling&&this.parentNode.appendChild(this)}function i(){return this.each(r)}n.d(e,{A:()=>i})},6805(t,e,n){function r(){return Math.random()}n.d(e,{A:()=>r})},6911(t,e,n){var r=Array.prototype;r.map,r.slice},7119(t,e,n){Math.sqrt(50),Math.sqrt(10),Math.sqrt(2)},7137(t,e,n){n.d(e,{A:()=>u});var r=n(3105),i=n(2492),o=n(8578),a=n(4036),s={time:null,delay:0,duration:250,ease:o.wq};function l(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return s.time=(0,a.tB)(),s;return n}function u(t){var e,n;t instanceof r.eB?(e=t._id,t=t._name):(e=(0,r.Si)(),(n=s).time=(0,a.tB)(),t=null==t?null:t+\"\");for(var o=this._groups,u=o.length,h=0;h<u;++h)for(var c,d=o[h],f=d.length,p=0;p<f;++p)(c=d[p])&&(0,i.Ay)(c,t,e,p,d,n||l(c,e));return new r.eB(o,this._parents,t,e)}},7204(t,e,n){n.d(e,{A:()=>i});var r=n(1927);function i(t){return\"string\"==typeof t?new r.LN([[document.querySelector(t)]],[document.documentElement]):new r.LN([[t]],r.zr)}},7360(t,e,n){n.d(e,{A:()=>i});var r=n(2492);function i(t,e){var n=this._id;return arguments.length<2?(0,r.Jt)(this.node(),n).on.on(t):this.each(function(t,e,n){var i,o,a=function(t){return(t+\"\").trim().split(/^|\\s+/).every(function(t){var e=t.indexOf(\".\");return e>=0&&(t=t.slice(0,e)),!t||\"start\"===t})}(e)?r.Ts:r.hZ;return function(){var r=a(this,t),s=r.on;s!==i&&(o=(i=s).copy()).on(e,n),r.on=o}}(n,t,e))}},7365(t,e,n){n.d(e,{A:()=>o,L:()=>a});var r=n(6707),i=n(1927);function o(){return new i.LN(this._enter||this._groups.map(r.A),this._parents)}function a(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}a.prototype={constructor:a,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}}},7387(t,e,n){Array.prototype.slice},7458(t,e,n){n(2285),n(7387),n(9567)},7490(t,e,n){var r=n(5800);function i(){}var o=r.A.prototype;i.prototype=function(t,e){var n=new i;if(t instanceof i)t.each(function(t){n.add(t)});else if(t){var r=-1,o=t.length;if(null==e)for(;++r<o;)n.add(t[r]);else for(;++r<o;)n.add(e(t[r],r,t))}return n}.prototype={constructor:i,has:o.has,add:function(t){return t+=\"\",this[r.P+t]=t,this},remove:o.remove,clear:o.clear,values:o.keys,size:o.size,empty:o.empty,each:o.each}},7515(t,e,n){n.d(e,{A:()=>i});var r=n(9134);function i(t){var e=\"function\"==typeof t?t:(0,r.A)(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}},7588(t,e,n){n.d(e,{A:()=>u});var r=n(2608),i=n(7626),o=n(2492),a=n(478),s=n(4938);function l(t){return function(){this.style.removeProperty(t)}}function u(t,e,n){var u=\"transform\"==(t+=\"\")?r.T:s.A;return null==e?this.styleTween(t,function(t,e){var n,r,o;return function(){var a=(0,i.j)(this,t),s=(this.style.removeProperty(t),(0,i.j)(this,t));return a===s?null:a===n&&s===r?o:o=e(n=a,r=s)}}(t,u)).on(\"end.style.\"+t,l(t)):\"function\"==typeof e?this.styleTween(t,function(t,e,n){var r,o,a;return function(){var s=(0,i.j)(this,t),l=n(this),u=l+\"\";return null==l&&(this.style.removeProperty(t),u=l=(0,i.j)(this,t)),s===u?null:s===r&&u===o?a:(o=u,a=e(r=s,l))}}(t,u,(0,a.J)(this,\"style.\"+t,e))).each(function(t,e){var n,r,i,a,s=\"style.\"+e,u=\"end.\"+s;return function(){var h=(0,o.hZ)(this,t),c=h.on,d=null==h.value[s]?a||(a=l(e)):void 0;c===n&&i===d||(r=(n=c).copy()).on(u,i=d),h.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,o,a=n+\"\";return function(){var s=(0,i.j)(this,t);return s===a?null:s===r?o:o=e(r=s,n)}}(t,u,e),n).on(\"end.style.\"+t,null)}},7592(t,e,n){function r(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function i(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}n.d(e,{A:()=>r,X:()=>i})},7626(t,e,n){n.d(e,{A:()=>s,j:()=>l});var r=n(2684);function i(t){return function(){this.style.removeProperty(t)}}function o(t,e,n){return function(){this.style.setProperty(t,e,n)}}function a(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function s(t,e,n){return arguments.length>1?this.each((null==e?i:\"function\"==typeof e?a:o)(t,e,null==n?\"\":n)):l(this.node(),t)}function l(t,e){return t.style.getPropertyValue(e)||(0,r.A)(t).getComputedStyle(t,null).getPropertyValue(e)}},7644(t,e,n){n.d(e,{A:()=>h});var r=n(6357);function i(t){return function(){this.removeAttribute(t)}}function o(t){return function(){this.removeAttributeNS(t.space,t.local)}}function a(t,e){return function(){this.setAttribute(t,e)}}function s(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function l(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function u(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function h(t,e){var n=(0,r.A)(t);if(arguments.length<2){var h=this.node();return n.local?h.getAttributeNS(n.space,n.local):h.getAttribute(n)}return this.each((null==e?n.local?o:i:\"function\"==typeof e?n.local?u:l:n.local?s:a)(n,e))}},7737(t,e,n){n.d(e,{$Y:()=>a,$e:()=>u,Qd:()=>i,iX:()=>o});var r=n(2415);function i(t,e,n,i){var o=[null,null],s=r.Jo.push(o)-1;return o.left=t,o.right=e,n&&a(o,t,e,n),i&&a(o,e,t,i),r.Yo[t.index].halfedges.push(s),r.Yo[e.index].halfedges.push(s),o}function o(t,e,n){var r=[e,n];return r.left=t,r}function a(t,e,n,r){t[0]||t[1]?t.left===n?t[1]=r:t[0]=r:(t[0]=r,t.left=e,t.right=n)}function s(t,e,n,r,i){var o,a=t[0],s=t[1],l=a[0],u=a[1],h=0,c=1,d=s[0]-l,f=s[1]-u;if(o=e-l,d||!(o>0)){if(o/=d,d<0){if(o<h)return;o<c&&(c=o)}else if(d>0){if(o>c)return;o>h&&(h=o)}if(o=r-l,d||!(o<0)){if(o/=d,d<0){if(o>c)return;o>h&&(h=o)}else if(d>0){if(o<h)return;o<c&&(c=o)}if(o=n-u,f||!(o>0)){if(o/=f,f<0){if(o<h)return;o<c&&(c=o)}else if(f>0){if(o>c)return;o>h&&(h=o)}if(o=i-u,f||!(o<0)){if(o/=f,f<0){if(o>c)return;o>h&&(h=o)}else if(f>0){if(o<h)return;o<c&&(c=o)}return!(h>0||c<1)||(h>0&&(t[0]=[l+h*d,u+h*f]),c<1&&(t[1]=[l+c*d,u+c*f]),!0)}}}}}function l(t,e,n,r,i){var o=t[1];if(o)return!0;var a,s,l=t[0],u=t.left,h=t.right,c=u[0],d=u[1],f=h[0],p=h[1],g=(c+f)/2,m=(d+p)/2;if(p===d){if(g<e||g>=r)return;if(c>f){if(l){if(l[1]>=i)return}else l=[g,n];o=[g,i]}else{if(l){if(l[1]<n)return}else l=[g,i];o=[g,n]}}else if(s=m-(a=(c-f)/(p-d))*g,a<-1||a>1)if(c>f){if(l){if(l[1]>=i)return}else l=[(n-s)/a,n];o=[(i-s)/a,i]}else{if(l){if(l[1]<n)return}else l=[(i-s)/a,i];o=[(n-s)/a,n]}else if(d<p){if(l){if(l[0]>=r)return}else l=[e,a*e+s];o=[r,a*r+s]}else{if(l){if(l[0]<e)return}else l=[r,a*r+s];o=[e,a*e+s]}return t[0]=l,t[1]=o,!0}function u(t,e,n,i){for(var o,a=r.Jo.length;a--;)l(o=r.Jo[a],t,e,n,i)&&s(o,t,e,n,i)&&(Math.abs(o[0][0]-o[1][0])>r.Ni||Math.abs(o[0][1]-o[1][1])>r.Ni)||delete r.Jo[a]}},7772(t,e,n){n(6100)},7773(t,e,n){n(4725)},7778(t,e,n){function r(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function i(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function o(t){return this.select(t?i:r)}n.d(e,{A:()=>o})},7787(t,e,n){n.d(e,{A:()=>o});var r=n(1927),i=n(9729);function o(t){\"function\"!=typeof t&&(t=(0,i.A)(t));for(var e=this._groups,n=e.length,o=new Array(n),a=0;a<n;++a)for(var s,l,u=e[a],h=u.length,c=o[a]=new Array(h),d=0;d<h;++d)(s=u[d])&&(l=t.call(s,s.__data__,d,u))&&(\"__data__\"in s&&(l.__data__=s.__data__),c[d]=l);return new r.LN(o,this._parents)}},7866(t,e,n){n(8961),n(1901)},7870(t,e,n){n(2285),n(6479)},7971(t,e,n){function r(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}n.d(e,{A:()=>r})},8002(t,e,n){n(5800)},8035(t,e,n){n.d(e,{A:()=>o});var r=n(4692),i=n(3105);function o(t){\"function\"!=typeof t&&(t=(0,r.A)(t));for(var e=this._groups,n=e.length,o=new Array(n),a=0;a<n;++a)for(var s,l=e[a],u=l.length,h=o[a]=[],c=0;c<u;++c)(s=l[c])&&t.call(s,s.__data__,c,l)&&h.push(s);return new i.eB(o,this._parents,this._name,this._id)}},8059(t,e,n){n(2285),n(6527)},8160(t,e,n){n(2415)},8176(t,e,n){n.d(e,{A:()=>i,g:()=>r});var r=\"http://www.w3.org/1999/xhtml\";const i={svg:\"http://www.w3.org/2000/svg\",xhtml:r,xlink:\"http://www.w3.org/1999/xlink\",xml:\"http://www.w3.org/XML/1998/namespace\",xmlns:\"http://www.w3.org/2000/xmlns/\"}},8198(t,e,n){function r(t){return function(){delete this[t]}}function i(t,e){return function(){this[t]=e}}function o(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function a(t,e){return arguments.length>1?this.each((null==e?r:\"function\"==typeof e?o:i)(t,e)):this.node()[t]}n.d(e,{A:()=>a})},8279(t,e,n){n.d(e,{A:()=>i});var r=n(2492);function i(t){var e=this._id;return arguments.length?this.each(function(t,e){if(\"function\"!=typeof e)throw new Error;return function(){(0,r.hZ)(this,t).ease=e}}(e,t)):(0,r.Jt)(this.node(),e).ease}},8299(t,e,n){n(1650)},8310(t,e,n){n(362)},8326(t,e,n){n.d(e,{A:()=>a});var r=n(2492);function i(t,e){return function(){(0,r.Ts)(this,t).delay=+e.apply(this,arguments)}}function o(t,e){return e=+e,function(){(0,r.Ts)(this,t).delay=e}}function a(t){var e=this._id;return arguments.length?this.each((\"function\"==typeof t?i:o)(e,t)):(0,r.Jt)(this.node(),e).delay}},8340(t,e,n){function r(t){return arguments.length?this.property(\"__data__\",t):this.node().__data__}n.d(e,{A:()=>r})},8440(t,e,n){n(1650),Math.PI,Math.sqrt(5)},8464(t,e,n){function r(t){return function(){return t}}n.d(e,{A:()=>r})},8534(t,e,n){n(9567),n(7458)},8561(t,e,n){n(7866),n(1901)},8569(t,e,n){function r(){return this.on(\"end.remove\",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t}n.d(e,{A:()=>r})},8578(t,e,n){function r(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}n.d(e,{wq:()=>r})},8615(t,e,n){function r(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null}n.d(e,{A:()=>r})},8625(t,e,n){n.d(e,{A:()=>a});var r=n(2492);function i(t,e){return function(){(0,r.hZ)(this,t).duration=+e.apply(this,arguments)}}function o(t,e){return e=+e,function(){(0,r.hZ)(this,t).duration=e}}function a(t){var e=this._id;return arguments.length?this.each((\"function\"==typeof t?i:o)(e,t)):(0,r.Jt)(this.node(),e).duration}},8653(t,e,n){n.d(e,{A:()=>a});var r=n(9729),i=n(3105),o=n(2492);function a(t){var e=this._name,n=this._id;\"function\"!=typeof t&&(t=(0,r.A)(t));for(var a=this._groups,s=a.length,l=new Array(s),u=0;u<s;++u)for(var h,c,d=a[u],f=d.length,p=l[u]=new Array(f),g=0;g<f;++g)(h=d[g])&&(c=t.call(h,h.__data__,g,d))&&(\"__data__\"in h&&(c.__data__=h.__data__),p[g]=c,(0,o.Ay)(p[g],e,n,g,p,(0,o.Jt)(h,n)));return new i.eB(l,this._parents,e,n)}},8900(t,e,n){n(481),n(6479)},8958(t,e,n){function r(){return!this.node()}n.d(e,{A:()=>r})},8961(t,e,n){n(5276),n(3105),n(9859),n(6038)},9115(t,e,n){function r(){var t=this.parentNode;t&&t.removeChild(this)}function i(){return this.each(r)}n.d(e,{A:()=>i})},9134(t,e,n){n.d(e,{A:()=>s});var r=n(6357),i=n(8176);function o(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===i.g&&e.documentElement.namespaceURI===i.g?e.createElement(t):e.createElementNS(n,t)}}function a(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function s(t){var e=(0,r.A)(t);return(e.local?a:o)(e)}},9278(t,e,n){function r(){this._=null}function i(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function o(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function a(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function s(t){for(;t.L;)t=t.L;return t}n.d(e,{A:()=>l,T:()=>i}),r.prototype={constructor:r,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=s(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(r=n.U).L?(i=r.R)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(o(this,n),n=(t=n).U),n.C=!1,r.C=!0,a(this,r)):(i=r.L)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(a(this,n),n=(t=n).U),n.C=!1,r.C=!0,o(this,r)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,l=t.L,u=t.R;if(n=l?u?s(u):l:u,i?i.L===t?i.L=n:i.R=n:this._=n,l&&u?(r=n.C,n.C=t.C,n.L=l,l.U=n,n!==u?(i=n.U,n.U=t.U,t=n.R,i.L=t,n.R=u,u.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((e=i.R).C&&(e.C=!1,i.C=!0,o(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,a(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,o(this,i),t=this._;break}}else if((e=i.L).C&&(e.C=!1,i.C=!0,a(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,o(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,a(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};const l=r},9450(t,e,n){n.d(e,{A:()=>a});var r=n(9134),i=n(9729);function o(){return null}function a(t,e){var n=\"function\"==typeof t?t:(0,r.A)(t),a=null==e?o:\"function\"==typeof e?e:(0,i.A)(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),a.apply(this,arguments)||null)})}},9497(t,e,n){n.d(e,{v:()=>r});class r{constructor(t,e,n){this.container=t,this.host=e,this.expandCollapseState=n,this.initializeDOM()}initializeDOM(){this.container.innerHTML=\"\",this.container.className=\"matrix-visual-container\",this.container.style.position=\"relative\",this.container.style.width=\"100%\",this.container.style.height=\"100%\",this.container.style.overflow=\"hidden\",this.container.style.fontFamily=\"Segoe UI, -apple-system, BlinkMacSystemFont, sans-serif\",this.container.style.fontSize=\"11px\",this.tableWrapper=document.createElement(\"div\"),this.tableWrapper.className=\"matrix-table-wrapper\",this.tableWrapper.style.position=\"relative\",this.tableWrapper.style.width=\"100%\",this.tableWrapper.style.height=\"100%\",this.tableWrapper.style.overflow=\"auto\",this.headerWrapper=document.createElement(\"div\"),this.headerWrapper.className=\"matrix-header-wrapper\",this.headerWrapper.style.position=\"sticky\",this.headerWrapper.style.top=\"0\",this.headerWrapper.style.zIndex=\"10\",this.headerWrapper.style.backgroundColor=\"#ffffff\",this.bodyWrapper=document.createElement(\"div\"),this.bodyWrapper.className=\"matrix-body-wrapper\",this.rowHeaderWrapper=document.createElement(\"div\"),this.rowHeaderWrapper.className=\"matrix-row-header-wrapper\",this.rowHeaderWrapper.style.position=\"absolute\",this.rowHeaderWrapper.style.left=\"0\",this.rowHeaderWrapper.style.top=\"0\",this.rowHeaderWrapper.style.zIndex=\"11\",this.rowHeaderWrapper.style.backgroundColor=\"#ffffff\",this.rowHeaderWrapper.style.boxShadow=\"2px 0 4px rgba(0,0,0,0.1)\",this.table=document.createElement(\"table\"),this.table.className=\"matrix-table\",this.table.style.borderCollapse=\"collapse\",this.table.style.width=\"100%\",this.table.style.tableLayout=\"auto\",this.table.cellSpacing=\"0\",this.table.cellPadding=\"0\",this.rowHeaderTable=document.createElement(\"table\"),this.rowHeaderTable.className=\"matrix-row-header-table\",this.rowHeaderTable.style.borderCollapse=\"collapse\",this.rowHeaderTable.style.tableLayout=\"auto\",this.rowHeaderTable.cellSpacing=\"0\",this.rowHeaderTable.cellPadding=\"0\",this.tableWrapper.appendChild(this.headerWrapper),this.tableWrapper.appendChild(this.bodyWrapper),this.container.appendChild(this.tableWrapper),this.container.appendChild(this.rowHeaderWrapper)}render(t,e,n){const r=t.getFlattenedRows(t.getRowHierarchy(this.expandCollapseState)),i=t.getFlattenedColumns(t.getColumnHierarchy(this.expandCollapseState)),o=t.getValueColumns();this.headerWrapper.innerHTML=\"\",this.bodyWrapper.innerHTML=\"\",this.rowHeaderWrapper.innerHTML=\"\",this.renderColumnHeaders(i,t.getRowLevels(),o,e),this.renderRows(r,i,t,e),this.renderRowHeaders(r,t.getRowLevels(),e),this.syncScroll()}renderColumnHeaders(t,e,n,r){const i=document.createElement(\"table\");i.className=\"matrix-header-table\",i.style.borderCollapse=\"collapse\",i.style.width=\"100%\",i.style.tableLayout=\"auto\";const o=t.length>0?Math.max(...t.map(t=>t.level)):0,a=[];for(let t=0;t<=o;t++){const e=document.createElement(\"tr\");e.className=`header-row level-${t}`,a.push(e)}const s=150*e;for(let t=0;t<=o;t++){const e=document.createElement(\"th\");e.className=\"header-spacer\",e.style.width=`${s}px`,e.style.minWidth=`${s}px`,e.style.padding=\"8px\",e.style.border=\"1px solid #e0e0e0\",e.style.backgroundColor=\"#f8f8f8\",a[t].appendChild(e)}const l=new Map;for(const e of t)if(e.level===o){const t=e.path.slice(0,-1).join(\"|\");l.has(t)||l.set(t,[]),l.get(t).push(e)}for(const[t,e]of l.entries()){const r=t.split(\"|\");for(let t=0;t<r.length;t++){const n=r.slice(0,t+1),i=t===r.length-1,o=i?e.length:1,s=a[t].querySelector(`[data-path=\"${n.join(\"|\")}\"]`);if(s)i&&s.setAttribute(\"colspan\",o.toString());else{const e=document.createElement(\"th\");e.className=`column-header level-${t}`,e.setAttribute(\"data-path\",n.join(\"|\")),o>1&&e.setAttribute(\"colspan\",o.toString()),e.textContent=r[t]||\"\",e.style.padding=\"8px\",e.style.border=\"1px solid #e0e0e0\",e.style.backgroundColor=\"#f8f8f8\",e.style.textAlign=\"center\",e.style.fontWeight=\"600\",e.style.whiteSpace=\"nowrap\",a[t].appendChild(e)}}for(const t of e){const e=document.createElement(\"th\");e.className=\"column-header value-header\";const r=n[t.valueColumnIndex||0];e.textContent=r?.source?.displayName||r?.source?.queryName||\"\",e.style.padding=\"8px\",e.style.border=\"1px solid #e0e0e0\",e.style.backgroundColor=\"#f8f8f8\",e.style.textAlign=\"center\",e.style.fontWeight=\"600\",e.style.whiteSpace=\"nowrap\",e.style.minWidth=\"100px\",a[o].appendChild(e)}}for(const t of a)i.appendChild(t);this.headerWrapper.appendChild(i)}renderRows(t,e,n,r){const i=document.createElement(\"table\");i.className=\"matrix-body-table\",i.style.borderCollapse=\"collapse\",i.style.width=\"100%\",i.style.tableLayout=\"auto\";for(const r of t){const t=document.createElement(\"tr\");t.className=`data-row level-${r.level} ${r.isSubtotal?\"subtotal-row\":\"\"}`,t.setAttribute(\"data-row-path\",r.path.join(\"|\"));const o=document.createElement(\"td\");o.className=\"row-spacer\",o.style.width=150*n.getRowLevels()+\"px\",o.style.minWidth=150*n.getRowLevels()+\"px\",o.style.padding=\"0\",o.style.border=\"none\",t.appendChild(o);const a=e.length>0?Math.max(...e.map(t=>t.level)):0;for(const i of e)if(i.level===a){const e=n.getCellValue(r.path,i.path,i.valueColumnIndex||0),o=document.createElement(\"td\");o.className=\"data-cell \"+(r.isSubtotal?\"subtotal-cell\":\"\"),o.textContent=e?.formattedValue||\"\",o.style.padding=\"8px\",o.style.border=\"1px solid #e0e0e0\",o.style.textAlign=\"right\",o.style.whiteSpace=\"nowrap\",o.style.fontSize=\"11px\",r.isSubtotal&&(o.style.fontWeight=\"600\",o.style.backgroundColor=\"#f0f0f0\"),t.appendChild(o)}i.appendChild(t)}this.bodyWrapper.appendChild(i)}renderRowHeaders(t,e,n){this.rowHeaderTable.innerHTML=\"\";const r=document.createElement(\"tr\");for(let t=0;t<e;t++){const t=document.createElement(\"th\");t.className=\"row-header-header\",t.style.padding=\"8px\",t.style.border=\"1px solid #e0e0e0\",t.style.backgroundColor=\"#f8f8f8\",t.style.fontWeight=\"600\",t.style.width=\"150px\",t.style.minWidth=\"150px\",r.appendChild(t)}this.rowHeaderTable.appendChild(r);for(const n of t){const t=document.createElement(\"tr\");t.className=`row-header-row level-${n.level}`,t.style.height=\"30px\";for(let r=0;r<e;r++){const e=document.createElement(\"td\");if(e.className=`row-header-cell level-${r}`,e.style.padding=\"8px\",e.style.border=\"1px solid #e0e0e0\",e.style.backgroundColor=\"#ffffff\",e.style.whiteSpace=\"nowrap\",e.style.width=\"150px\",e.style.minWidth=\"150px\",r===n.level){const t=20*r;if(e.style.paddingLeft=`${8+t}px`,n.node.children&&n.node.children.length>0){const t=document.createElement(\"span\");t.className=\"expand-indicator\",t.textContent=n.isExpanded?\"−\":\"+\",t.style.display=\"inline-block\",t.style.width=\"16px\",t.style.height=\"16px\",t.style.marginRight=\"4px\",t.style.textAlign=\"center\",t.style.lineHeight=\"16px\",t.style.cursor=\"pointer\",t.style.userSelect=\"none\",t.style.fontWeight=\"bold\",t.style.fontSize=\"14px\",t.setAttribute(\"data-path\",n.path.join(\"|\")),e.appendChild(t)}e.appendChild(document.createTextNode(n.node.value?.toString()||\"\")),n.isSubtotal&&(e.style.fontWeight=\"600\",e.style.backgroundColor=\"#f0f0f0\")}t.appendChild(e)}this.rowHeaderTable.appendChild(t)}this.rowHeaderWrapper.appendChild(this.rowHeaderTable)}syncScroll(){this.tableWrapper.addEventListener(\"scroll\",()=>{this.rowHeaderWrapper.scrollTop=this.tableWrapper.scrollTop}),this.rowHeaderWrapper.addEventListener(\"scroll\",()=>{this.tableWrapper.scrollTop=this.rowHeaderWrapper.scrollTop})}getExpandCollapseElements(){return this.rowHeaderWrapper.querySelectorAll(\".expand-indicator\")}}},9567(t,e,n){n(2285),n(7387)},9609(t,e,n){n(2285),n(6911)},9650(t,e,n){n.d(e,{A:()=>a});var r=n(1118),i=n(3105),o=n(2492);function a(t){var e=this._name,n=this._id;\"function\"!=typeof t&&(t=(0,r.A)(t));for(var a=this._groups,s=a.length,l=[],u=[],h=0;h<s;++h)for(var c,d=a[h],f=d.length,p=0;p<f;++p)if(c=d[p]){for(var g,m=t.call(c,c.__data__,p,d),v=(0,o.Jt)(c,n),y=0,w=m.length;y<w;++y)(g=m[y])&&(0,o.Ay)(g,e,n,y,m,v);l.push(m),u.push(c)}return new i.eB(l,u,e,n)}},9721(t,e,n){n.d(e,{A:()=>o});var r=n(1927),i=n(4692);function o(t){\"function\"!=typeof t&&(t=(0,i.A)(t));for(var e=this._groups,n=e.length,o=new Array(n),a=0;a<n;++a)for(var s,l=e[a],u=l.length,h=o[a]=[],c=0;c<u;++c)(s=l[c])&&t.call(s,s.__data__,c,l)&&h.push(s);return new r.LN(o,this._parents)}},9724(t,e,n){n.d(e,{A:()=>i});var r=n(2492);function i(){var t,e,n=this,i=n._id,o=n.size();return new Promise(function(a,s){var l={value:s},u={value:function(){0===--o&&a()}};n.each(function(){var n=(0,r.hZ)(this,i),o=n.on;o!==t&&((e=(t=o).copy())._.cancel.push(l),e._.interrupt.push(l),e._.end.push(u)),n.on=e})})}},9729(t,e,n){function r(){}function i(t){return null==t?r:function(){return this.querySelector(t)}}n.d(e,{A:()=>i})},9798(t,e,n){n(6911),n(481)},9859(t,e,n){n(3105),n(2492)},9918(t,e,n){function r(){var t=0;return this.each(function(){++t}),t}n.d(e,{A:()=>r})},9948(t,e,n){n.d(e,{Ay:()=>s});var r=n(3844),i=n(3029),o=n(4425),a=n(6504);const s=function t(e){var n=(0,a.uN)(e);function i(t,e){var i=n((t=(0,r.Qh)(t)).r,(e=(0,r.Qh)(e)).r),o=n(t.g,e.g),s=n(t.b,e.b),l=(0,a.Ay)(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=o(e),t.b=s(e),t.opacity=l(e),t+\"\"}}return i.gamma=t,i}(1);function l(t){return function(e){var n,i,o=e.length,a=new Array(o),s=new Array(o),l=new Array(o);for(n=0;n<o;++n)i=(0,r.Qh)(e[n]),a[n]=i.r||0,s[n]=i.g||0,l[n]=i.b||0;return a=t(a),s=t(s),l=t(l),i.opacity=1,function(t){return i.r=a(t),i.g=s(t),i.b=l(t),i+\"\"}}}l(i.A),l(o.A)}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})};var r={};(()=>{n.r(r),n.d(r,{default:()=>o});var t=n(5789),e=window.powerbi,i={name:\"matrixVisualReplica1234567890ABCDEF\",displayName:\"Matrix Visual Replica\",class:\"MatrixVisualReplica\",apiVersion:\"5.10.0\",create:e=>{if(t.S)return new t.S(e);throw\"Visual instance not found\"},createModalDialog:(t,e,n)=>{const r=globalThis.dialogRegistry;t in r&&new r[t](e,n)},custom:!0};void 0!==e&&(e.visuals=e.visuals||{},e.visuals.plugins=e.visuals.plugins||{},e.visuals.plugins.matrixVisualReplica1234567890ABCDEF=i);const o=i})(),matrixVisualReplica1234567890ABCDEF=r})();","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg=="},"visualEntryPoint":""}